{"ast":null,"code":"import * as React from 'react';\nimport { FocusZone } from '../../../FocusZone';\nimport { addYears, setMonth, getYearStart, getYearEnd, getMonthStart, getMonthEnd, compareDatePart, DEFAULT_DATE_FORMATTING } from '@fluentui/date-time-utilities';\nimport { Icon } from '../../../Icon';\nimport { getStyles } from './CalendarMonth.styles';\nimport { css, getRTL, classNamesFunction, KeyCodes, format, getPropsWithDefaults } from '@fluentui/utilities';\nimport { CalendarYear } from '../CalendarYear/CalendarYear';\nimport { usePrevious } from '@fluentui/react-hooks';\nimport { defaultCalendarNavigationIcons } from '../defaults';\nvar MONTHS_PER_ROW = 4;\nvar getClassNames = classNamesFunction();\nvar DEFAULT_PROPS = {\n  styles: getStyles,\n  strings: undefined,\n  navigationIcons: defaultCalendarNavigationIcons,\n  dateTimeFormatter: DEFAULT_DATE_FORMATTING,\n  yearPickerHidden: false\n};\n\nfunction useAnimateBackwards(_a) {\n  var navigatedDate = _a.navigatedDate;\n  var currentYear = navigatedDate.getFullYear();\n  var previousYear = usePrevious(currentYear);\n\n  if (previousYear === undefined || previousYear === currentYear) {\n    return undefined;\n  } else {\n    return previousYear > currentYear;\n  }\n}\n\nfunction useFocusLogic(_a) {\n  var componentRef = _a.componentRef;\n  var navigatedMonthRef = React.useRef(null);\n  var calendarYearRef = React.useRef(null);\n  var focusOnUpdate = React.useRef(false);\n  var focus = React.useCallback(function () {\n    if (calendarYearRef.current) {\n      calendarYearRef.current.focus();\n    } else if (navigatedMonthRef.current) {\n      navigatedMonthRef.current.focus();\n    }\n  }, []);\n  React.useImperativeHandle(componentRef, function () {\n    return {\n      focus: focus\n    };\n  }, [focus]);\n  React.useEffect(function () {\n    if (focusOnUpdate.current) {\n      focus();\n      focusOnUpdate.current = false;\n    }\n  });\n\n  var focusOnNextUpdate = function () {\n    focusOnUpdate.current = true;\n  };\n\n  return [navigatedMonthRef, calendarYearRef, focusOnNextUpdate];\n}\n\nexport var CalendarMonthBase = function (propsWithoutDefaults) {\n  var _a, _b;\n\n  var props = getPropsWithDefaults(DEFAULT_PROPS, propsWithoutDefaults);\n\n  var _c = useFocusLogic(props),\n      navigatedMonthRef = _c[0],\n      calendarYearRef = _c[1],\n      focusOnNextUpdate = _c[2];\n\n  var _d = React.useState(false),\n      isYearPickerVisible = _d[0],\n      setIsYearPickerVisible = _d[1];\n\n  var animateBackwards = useAnimateBackwards(props);\n  var navigatedDate = props.navigatedDate,\n      selectedDate = props.selectedDate,\n      strings = props.strings,\n      _e = props.today,\n      today = _e === void 0 ? new Date() : _e,\n      navigationIcons = props.navigationIcons,\n      dateTimeFormatter = props.dateTimeFormatter,\n      minDate = props.minDate,\n      maxDate = props.maxDate,\n      theme = props.theme,\n      styles = props.styles,\n      className = props.className,\n      allFocusable = props.allFocusable,\n      highlightCurrentMonth = props.highlightCurrentMonth,\n      highlightSelectedMonth = props.highlightSelectedMonth,\n      animationDirection = props.animationDirection,\n      yearPickerHidden = props.yearPickerHidden,\n      onNavigateDate = props.onNavigateDate;\n\n  var selectMonthCallback = function (newMonth) {\n    return function () {\n      return onSelectMonth(newMonth);\n    };\n  };\n\n  var onSelectNextYear = function () {\n    onNavigateDate(addYears(navigatedDate, 1), false);\n  };\n\n  var onSelectPrevYear = function () {\n    onNavigateDate(addYears(navigatedDate, -1), false);\n  };\n\n  var onSelectMonth = function (newMonth) {\n    var _a; // If header is clickable the calendars are overlayed, switch back to day picker when month is clicked\n\n\n    (_a = props.onHeaderSelect) === null || _a === void 0 ? void 0 : _a.call(props);\n    onNavigateDate(setMonth(navigatedDate, newMonth), true);\n  };\n\n  var onHeaderSelect = function () {\n    var _a;\n\n    if (!yearPickerHidden) {\n      focusOnNextUpdate();\n      setIsYearPickerVisible(true);\n    } else {\n      (_a = props.onHeaderSelect) === null || _a === void 0 ? void 0 : _a.call(props);\n    }\n  };\n\n  var onSelectYear = function (selectedYear) {\n    focusOnNextUpdate();\n    var navYear = navigatedDate.getFullYear();\n\n    if (navYear !== selectedYear) {\n      var newNavigationDate = new Date(navigatedDate.getTime());\n      newNavigationDate.setFullYear(selectedYear); // for min and max dates, adjust the new navigation date - perhaps this should be\n      // checked on the master navigation date handler (i.e. in Calendar)\n\n      if (maxDate && newNavigationDate > maxDate) {\n        newNavigationDate = setMonth(newNavigationDate, maxDate.getMonth());\n      } else if (minDate && newNavigationDate < minDate) {\n        newNavigationDate = setMonth(newNavigationDate, minDate.getMonth());\n      }\n\n      onNavigateDate(newNavigationDate, true);\n    }\n\n    setIsYearPickerVisible(false);\n  };\n\n  var onYearPickerHeaderSelect = function (focus) {\n    focusOnNextUpdate();\n    setIsYearPickerVisible(false);\n  }; // navigationIcons has a default value in defaultProps, but typescript doesn't recognize this\n\n\n  var leftNavigationIcon = navigationIcons.leftNavigation;\n  var rightNavigationIcon = navigationIcons.rightNavigation;\n  var dateFormatter = dateTimeFormatter; // determine if previous/next years are in bounds\n\n  var isPrevYearInBounds = minDate ? compareDatePart(minDate, getYearStart(navigatedDate)) < 0 : true;\n  var isNextYearInBounds = maxDate ? compareDatePart(getYearEnd(navigatedDate), maxDate) < 0 : true;\n  var classNames = getClassNames(styles, {\n    theme: theme,\n    className: className,\n    hasHeaderClickCallback: !!props.onHeaderSelect || !yearPickerHidden,\n    highlightCurrent: highlightCurrentMonth,\n    highlightSelected: highlightSelectedMonth,\n    animateBackwards: animateBackwards,\n    animationDirection: animationDirection\n  });\n\n  if (isYearPickerVisible) {\n    var _f = getYearStrings(props),\n        onRenderYear = _f[0],\n        yearStrings = _f[1]; // use navigated date for the year picker\n\n\n    return React.createElement(CalendarYear, {\n      key: 'calendarYear',\n      minYear: minDate ? minDate.getFullYear() : undefined,\n      maxYear: maxDate ? maxDate.getFullYear() : undefined,\n      // eslint-disable-next-line react/jsx-no-bind\n      onSelectYear: onSelectYear,\n      navigationIcons: navigationIcons,\n      // eslint-disable-next-line react/jsx-no-bind\n      onHeaderSelect: onYearPickerHeaderSelect,\n      selectedYear: selectedDate ? selectedDate.getFullYear() : navigatedDate ? navigatedDate.getFullYear() : undefined,\n      onRenderYear: onRenderYear,\n      strings: yearStrings,\n      componentRef: calendarYearRef,\n      styles: styles,\n      highlightCurrentYear: highlightCurrentMonth,\n      highlightSelectedYear: highlightSelectedMonth,\n      animationDirection: animationDirection\n    });\n  }\n\n  var rowIndexes = [];\n\n  for (var i = 0; i < strings.shortMonths.length / MONTHS_PER_ROW; i++) {\n    rowIndexes.push(i);\n  }\n\n  var yearString = dateFormatter.formatYear(navigatedDate);\n  var headerAriaLabel = strings.monthPickerHeaderAriaLabel ? format(strings.monthPickerHeaderAriaLabel, yearString) : yearString;\n  return React.createElement(\"div\", {\n    className: classNames.root\n  }, React.createElement(\"div\", {\n    className: classNames.headerContainer\n  }, React.createElement(\"button\", {\n    className: classNames.currentItemButton,\n    onClick: onHeaderSelect,\n    onKeyDown: onButtonKeyDown(onHeaderSelect),\n    \"aria-label\": headerAriaLabel,\n    \"data-is-focusable\": !!props.onHeaderSelect || !yearPickerHidden,\n    tabIndex: !!props.onHeaderSelect || !yearPickerHidden ? 0 : -1,\n    type: \"button\",\n    \"aria-atomic\": true,\n    \"aria-live\": \"polite\"\n  }, yearString), React.createElement(\"div\", {\n    className: classNames.navigationButtonsContainer\n  }, React.createElement(\"button\", {\n    className: css(classNames.navigationButton, (_a = {}, _a[classNames.disabled] = !isPrevYearInBounds, _a)),\n    \"aria-disabled\": !isPrevYearInBounds,\n    tabIndex: isPrevYearInBounds ? undefined : allFocusable ? 0 : -1,\n    onClick: isPrevYearInBounds ? onSelectPrevYear : undefined,\n    onKeyDown: isPrevYearInBounds ? onButtonKeyDown(onSelectPrevYear) : undefined,\n    title: strings.prevYearAriaLabel ? strings.prevYearAriaLabel + ' ' + dateFormatter.formatYear(addYears(navigatedDate, -1)) : undefined,\n    type: \"button\"\n  }, React.createElement(Icon, {\n    iconName: getRTL() ? rightNavigationIcon : leftNavigationIcon\n  })), React.createElement(\"button\", {\n    className: css(classNames.navigationButton, (_b = {}, _b[classNames.disabled] = !isNextYearInBounds, _b)),\n    \"aria-disabled\": !isNextYearInBounds,\n    tabIndex: isNextYearInBounds ? undefined : allFocusable ? 0 : -1,\n    onClick: isNextYearInBounds ? onSelectNextYear : undefined,\n    onKeyDown: isNextYearInBounds ? onButtonKeyDown(onSelectNextYear) : undefined,\n    title: strings.nextYearAriaLabel ? strings.nextYearAriaLabel + ' ' + dateFormatter.formatYear(addYears(navigatedDate, 1)) : undefined,\n    type: \"button\"\n  }, React.createElement(Icon, {\n    iconName: getRTL() ? leftNavigationIcon : rightNavigationIcon\n  })))), React.createElement(FocusZone, null, React.createElement(\"div\", {\n    className: classNames.gridContainer,\n    role: \"grid\",\n    \"aria-label\": yearString\n  }, rowIndexes.map(function (rowNum) {\n    var monthsForRow = strings.shortMonths.slice(rowNum * MONTHS_PER_ROW, (rowNum + 1) * MONTHS_PER_ROW);\n    return React.createElement(\"div\", {\n      key: 'monthRow_' + rowNum + navigatedDate.getFullYear(),\n      role: \"row\",\n      className: classNames.buttonRow\n    }, monthsForRow.map(function (month, index) {\n      var _a;\n\n      var monthIndex = rowNum * MONTHS_PER_ROW + index;\n      var indexedMonth = setMonth(navigatedDate, monthIndex);\n      var isNavigatedMonth = navigatedDate.getMonth() === monthIndex;\n      var isSelectedMonth = selectedDate.getMonth() === monthIndex;\n      var isSelectedYear = selectedDate.getFullYear() === navigatedDate.getFullYear();\n      var isInBounds = (minDate ? compareDatePart(minDate, getMonthEnd(indexedMonth)) < 1 : true) && (maxDate ? compareDatePart(getMonthStart(indexedMonth), maxDate) < 1 : true);\n      return React.createElement(\"button\", {\n        ref: isNavigatedMonth ? navigatedMonthRef : undefined,\n        role: 'gridcell',\n        className: css(classNames.itemButton, (_a = {}, _a[classNames.current] = highlightCurrentMonth && isCurrentMonth(monthIndex, navigatedDate.getFullYear(), today), _a[classNames.selected] = highlightSelectedMonth && isSelectedMonth && isSelectedYear, _a[classNames.disabled] = !isInBounds, _a)),\n        disabled: !allFocusable && !isInBounds,\n        key: monthIndex,\n        onClick: isInBounds ? selectMonthCallback(monthIndex) : undefined,\n        onKeyDown: isInBounds ? onButtonKeyDown(selectMonthCallback(monthIndex)) : undefined,\n        \"aria-label\": dateFormatter.formatMonth(indexedMonth, strings),\n        \"aria-selected\": isNavigatedMonth,\n        \"data-is-focusable\": isInBounds ? true : undefined,\n        type: \"button\",\n        \"aria-readonly\": true\n      }, month);\n    }));\n  }))));\n};\nCalendarMonthBase.displayName = 'CalendarMonthBase';\n\nfunction getYearStrings(_a) {\n  var strings = _a.strings,\n      navigatedDate = _a.navigatedDate,\n      dateTimeFormatter = _a.dateTimeFormatter;\n\n  var yearToString = function (year) {\n    if (dateTimeFormatter) {\n      // create a date based on the current nav date\n      var yearFormattingDate = new Date(navigatedDate.getTime());\n      yearFormattingDate.setFullYear(year);\n      return dateTimeFormatter.formatYear(yearFormattingDate);\n    }\n\n    return String(year);\n  };\n\n  var yearRangeToString = function (yearRange) {\n    return yearToString(yearRange.fromYear) + \" - \" + yearToString(yearRange.toYear);\n  };\n\n  var yearRangeToNextDecadeLabel = function (yearRange) {\n    return strings.nextYearRangeAriaLabel ? strings.nextYearRangeAriaLabel + \" \" + yearRangeToString(yearRange) : '';\n  };\n\n  var yearRangeToPrevDecadeLabel = function (yearRange) {\n    return strings.prevYearRangeAriaLabel ? strings.prevYearRangeAriaLabel + \" \" + yearRangeToString(yearRange) : '';\n  };\n\n  return [yearToString, {\n    rangeAriaLabel: yearRangeToString,\n    prevRangeAriaLabel: yearRangeToPrevDecadeLabel,\n    nextRangeAriaLabel: yearRangeToNextDecadeLabel,\n    headerAriaLabelFormatString: strings.yearPickerHeaderAriaLabel\n  }];\n}\n\nfunction isCurrentMonth(month, year, today) {\n  return today.getFullYear() === year && today.getMonth() === month;\n}\n\nfunction onButtonKeyDown(callback) {\n  return function (ev) {\n    // eslint-disable-next-line deprecation/deprecation\n    switch (ev.which) {\n      case KeyCodes.enter:\n        callback();\n        break;\n    }\n  };\n}","map":{"version":3,"sources":["components/Calendar/CalendarMonth/CalendarMonth.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { FocusZone } from '../../../FocusZone';\nimport {\n  addYears,\n  setMonth,\n  getYearStart,\n  getYearEnd,\n  getMonthStart,\n  getMonthEnd,\n  compareDatePart,\n  DEFAULT_DATE_FORMATTING,\n} from '@fluentui/date-time-utilities';\nimport { Icon } from '../../../Icon';\nimport { ICalendarMonthProps, ICalendarMonthStyles, ICalendarMonthStyleProps } from './CalendarMonth.types';\nimport { getStyles } from './CalendarMonth.styles';\nimport { css, getRTL, classNamesFunction, KeyCodes, format, getPropsWithDefaults } from '@fluentui/utilities';\nimport { ICalendarYear, ICalendarYearRange } from '../CalendarYear/CalendarYear.types';\nimport { CalendarYear } from '../CalendarYear/CalendarYear';\nimport { usePrevious } from '@fluentui/react-hooks';\nimport { defaultCalendarNavigationIcons } from '../defaults';\n\nconst MONTHS_PER_ROW = 4;\n\nconst getClassNames = classNamesFunction<ICalendarMonthStyleProps, ICalendarMonthStyles>();\n\nconst DEFAULT_PROPS: Readonly<Partial<ICalendarMonthProps>> = {\n  styles: getStyles,\n  strings: undefined,\n  navigationIcons: defaultCalendarNavigationIcons,\n  dateTimeFormatter: DEFAULT_DATE_FORMATTING,\n  yearPickerHidden: false,\n};\n\nfunction useAnimateBackwards({ navigatedDate }: ICalendarMonthProps) {\n  const currentYear = navigatedDate.getFullYear();\n  const previousYear = usePrevious(currentYear);\n\n  if (previousYear === undefined || previousYear === currentYear) {\n    return undefined;\n  } else {\n    return previousYear > currentYear;\n  }\n}\n\nfunction useFocusLogic({ componentRef }: ICalendarMonthProps) {\n  const navigatedMonthRef = React.useRef<HTMLButtonElement>(null);\n  const calendarYearRef = React.useRef<ICalendarYear>(null);\n  const focusOnUpdate = React.useRef(false);\n\n  const focus = React.useCallback(() => {\n    if (calendarYearRef.current) {\n      calendarYearRef.current.focus();\n    } else if (navigatedMonthRef.current) {\n      navigatedMonthRef.current.focus();\n    }\n  }, []);\n\n  React.useImperativeHandle(componentRef, () => ({ focus }), [focus]);\n\n  React.useEffect(() => {\n    if (focusOnUpdate.current) {\n      focus();\n      focusOnUpdate.current = false;\n    }\n  });\n\n  const focusOnNextUpdate = () => {\n    focusOnUpdate.current = true;\n  };\n\n  return [navigatedMonthRef, calendarYearRef, focusOnNextUpdate] as const;\n}\n\nexport const CalendarMonthBase: React.FunctionComponent<ICalendarMonthProps> = propsWithoutDefaults => {\n  const props = getPropsWithDefaults(DEFAULT_PROPS, propsWithoutDefaults);\n  const [navigatedMonthRef, calendarYearRef, focusOnNextUpdate] = useFocusLogic(props);\n  const [isYearPickerVisible, setIsYearPickerVisible] = React.useState(false);\n\n  const animateBackwards = useAnimateBackwards(props);\n\n  const {\n    navigatedDate,\n    selectedDate,\n    strings,\n    today = new Date(),\n    navigationIcons,\n    dateTimeFormatter,\n    minDate,\n    maxDate,\n    theme,\n    styles,\n    className,\n    allFocusable,\n    highlightCurrentMonth,\n    highlightSelectedMonth,\n    animationDirection,\n    yearPickerHidden,\n    onNavigateDate,\n  } = props;\n\n  const selectMonthCallback = (newMonth: number): (() => void) => {\n    return () => onSelectMonth(newMonth);\n  };\n\n  const onSelectNextYear = (): void => {\n    onNavigateDate(addYears(navigatedDate, 1), false);\n  };\n\n  const onSelectPrevYear = (): void => {\n    onNavigateDate(addYears(navigatedDate, -1), false);\n  };\n\n  const onSelectMonth = (newMonth: number): void => {\n    // If header is clickable the calendars are overlayed, switch back to day picker when month is clicked\n    props.onHeaderSelect?.();\n    onNavigateDate(setMonth(navigatedDate, newMonth), true);\n  };\n\n  const onHeaderSelect = (): void => {\n    if (!yearPickerHidden) {\n      focusOnNextUpdate();\n      setIsYearPickerVisible(true);\n    } else {\n      props.onHeaderSelect?.();\n    }\n  };\n\n  const onSelectYear = (selectedYear: number) => {\n    focusOnNextUpdate();\n    const navYear = navigatedDate.getFullYear();\n    if (navYear !== selectedYear) {\n      let newNavigationDate = new Date(navigatedDate.getTime());\n      newNavigationDate.setFullYear(selectedYear);\n      // for min and max dates, adjust the new navigation date - perhaps this should be\n      // checked on the master navigation date handler (i.e. in Calendar)\n      if (maxDate && newNavigationDate > maxDate) {\n        newNavigationDate = setMonth(newNavigationDate, maxDate.getMonth());\n      } else if (minDate && newNavigationDate < minDate) {\n        newNavigationDate = setMonth(newNavigationDate, minDate.getMonth());\n      }\n      onNavigateDate(newNavigationDate, true);\n    }\n    setIsYearPickerVisible(false);\n  };\n\n  const onYearPickerHeaderSelect = (focus: boolean): void => {\n    focusOnNextUpdate();\n    setIsYearPickerVisible(false);\n  };\n\n  // navigationIcons has a default value in defaultProps, but typescript doesn't recognize this\n  const leftNavigationIcon = navigationIcons!.leftNavigation;\n  const rightNavigationIcon = navigationIcons!.rightNavigation;\n  const dateFormatter = dateTimeFormatter!;\n\n  // determine if previous/next years are in bounds\n  const isPrevYearInBounds = minDate ? compareDatePart(minDate, getYearStart(navigatedDate)) < 0 : true;\n  const isNextYearInBounds = maxDate ? compareDatePart(getYearEnd(navigatedDate), maxDate) < 0 : true;\n\n  const classNames = getClassNames(styles, {\n    theme: theme!,\n    className: className,\n    hasHeaderClickCallback: !!props.onHeaderSelect || !yearPickerHidden,\n    highlightCurrent: highlightCurrentMonth,\n    highlightSelected: highlightSelectedMonth,\n    animateBackwards: animateBackwards,\n    animationDirection: animationDirection,\n  });\n\n  if (isYearPickerVisible) {\n    const [onRenderYear, yearStrings] = getYearStrings(props);\n    // use navigated date for the year picker\n    return (\n      <CalendarYear\n        key={'calendarYear'}\n        minYear={minDate ? minDate.getFullYear() : undefined}\n        maxYear={maxDate ? maxDate.getFullYear() : undefined}\n        // eslint-disable-next-line react/jsx-no-bind\n        onSelectYear={onSelectYear}\n        navigationIcons={navigationIcons}\n        // eslint-disable-next-line react/jsx-no-bind\n        onHeaderSelect={onYearPickerHeaderSelect}\n        selectedYear={\n          selectedDate ? selectedDate.getFullYear() : navigatedDate ? navigatedDate.getFullYear() : undefined\n        }\n        onRenderYear={onRenderYear}\n        strings={yearStrings}\n        componentRef={calendarYearRef}\n        styles={styles}\n        highlightCurrentYear={highlightCurrentMonth}\n        highlightSelectedYear={highlightSelectedMonth}\n        animationDirection={animationDirection}\n      />\n    );\n  }\n\n  const rowIndexes = [];\n  for (let i = 0; i < strings.shortMonths.length / MONTHS_PER_ROW; i++) {\n    rowIndexes.push(i);\n  }\n\n  const yearString = dateFormatter.formatYear(navigatedDate);\n  const headerAriaLabel = strings.monthPickerHeaderAriaLabel\n    ? format(strings.monthPickerHeaderAriaLabel, yearString)\n    : yearString;\n\n  return (\n    <div className={classNames.root}>\n      <div className={classNames.headerContainer}>\n        <button\n          className={classNames.currentItemButton}\n          onClick={onHeaderSelect}\n          onKeyDown={onButtonKeyDown(onHeaderSelect)}\n          aria-label={headerAriaLabel}\n          data-is-focusable={!!props.onHeaderSelect || !yearPickerHidden}\n          tabIndex={!!props.onHeaderSelect || !yearPickerHidden ? 0 : -1}\n          type=\"button\"\n          aria-atomic={true}\n          // if this component rerenders when text changes, aria-live will not be announced, so make key consistent\n          aria-live=\"polite\"\n        >\n          {yearString}\n        </button>\n        <div className={classNames.navigationButtonsContainer}>\n          <button\n            className={css(classNames.navigationButton, {\n              [classNames.disabled]: !isPrevYearInBounds,\n            })}\n            aria-disabled={!isPrevYearInBounds}\n            tabIndex={isPrevYearInBounds ? undefined : allFocusable ? 0 : -1}\n            onClick={isPrevYearInBounds ? onSelectPrevYear : undefined}\n            onKeyDown={isPrevYearInBounds ? onButtonKeyDown(onSelectPrevYear) : undefined}\n            title={\n              strings.prevYearAriaLabel\n                ? strings.prevYearAriaLabel + ' ' + dateFormatter.formatYear(addYears(navigatedDate, -1))\n                : undefined\n            }\n            type=\"button\"\n          >\n            <Icon iconName={getRTL() ? rightNavigationIcon : leftNavigationIcon} />\n          </button>\n          <button\n            className={css(classNames.navigationButton, {\n              [classNames.disabled]: !isNextYearInBounds,\n            })}\n            aria-disabled={!isNextYearInBounds}\n            tabIndex={isNextYearInBounds ? undefined : allFocusable ? 0 : -1}\n            onClick={isNextYearInBounds ? onSelectNextYear : undefined}\n            onKeyDown={isNextYearInBounds ? onButtonKeyDown(onSelectNextYear) : undefined}\n            title={\n              strings.nextYearAriaLabel\n                ? strings.nextYearAriaLabel + ' ' + dateFormatter.formatYear(addYears(navigatedDate, 1))\n                : undefined\n            }\n            type=\"button\"\n          >\n            <Icon iconName={getRTL() ? leftNavigationIcon : rightNavigationIcon} />\n          </button>\n        </div>\n      </div>\n      <FocusZone>\n        <div className={classNames.gridContainer} role=\"grid\" aria-label={yearString}>\n          {rowIndexes.map((rowNum: number) => {\n            const monthsForRow = strings.shortMonths.slice(rowNum * MONTHS_PER_ROW, (rowNum + 1) * MONTHS_PER_ROW);\n            return (\n              <div key={'monthRow_' + rowNum + navigatedDate.getFullYear()} role=\"row\" className={classNames.buttonRow}>\n                {monthsForRow.map((month: string, index: number) => {\n                  const monthIndex = rowNum * MONTHS_PER_ROW + index;\n                  const indexedMonth = setMonth(navigatedDate, monthIndex);\n                  const isNavigatedMonth = navigatedDate.getMonth() === monthIndex;\n                  const isSelectedMonth = selectedDate.getMonth() === monthIndex;\n                  const isSelectedYear = selectedDate.getFullYear() === navigatedDate.getFullYear();\n                  const isInBounds =\n                    (minDate ? compareDatePart(minDate, getMonthEnd(indexedMonth)) < 1 : true) &&\n                    (maxDate ? compareDatePart(getMonthStart(indexedMonth), maxDate) < 1 : true);\n\n                  return (\n                    <button\n                      ref={isNavigatedMonth ? navigatedMonthRef : undefined}\n                      role={'gridcell'}\n                      className={css(classNames.itemButton, {\n                        [classNames.current]:\n                          highlightCurrentMonth && isCurrentMonth(monthIndex, navigatedDate.getFullYear(), today),\n                        [classNames.selected]: highlightSelectedMonth && isSelectedMonth && isSelectedYear,\n                        [classNames.disabled]: !isInBounds,\n                      })}\n                      disabled={!allFocusable && !isInBounds}\n                      key={monthIndex}\n                      onClick={isInBounds ? selectMonthCallback(monthIndex) : undefined}\n                      onKeyDown={isInBounds ? onButtonKeyDown(selectMonthCallback(monthIndex)) : undefined}\n                      aria-label={dateFormatter.formatMonth(indexedMonth, strings)}\n                      aria-selected={isNavigatedMonth}\n                      data-is-focusable={isInBounds ? true : undefined}\n                      type=\"button\"\n                      aria-readonly={true} // prevent grid from being \"editable\"\n                    >\n                      {month}\n                    </button>\n                  );\n                })}\n              </div>\n            );\n          })}\n        </div>\n      </FocusZone>\n    </div>\n  );\n};\nCalendarMonthBase.displayName = 'CalendarMonthBase';\n\nfunction getYearStrings({ strings, navigatedDate, dateTimeFormatter }: ICalendarMonthProps) {\n  const yearToString = (year: number) => {\n    if (dateTimeFormatter) {\n      // create a date based on the current nav date\n      const yearFormattingDate = new Date(navigatedDate.getTime());\n      yearFormattingDate.setFullYear(year);\n      return dateTimeFormatter.formatYear(yearFormattingDate);\n    }\n    return String(year);\n  };\n\n  const yearRangeToString = (yearRange: ICalendarYearRange) => {\n    return `${yearToString(yearRange.fromYear)} - ${yearToString(yearRange.toYear)}`;\n  };\n\n  const yearRangeToNextDecadeLabel = (yearRange: ICalendarYearRange) => {\n    return strings.nextYearRangeAriaLabel ? `${strings.nextYearRangeAriaLabel} ${yearRangeToString(yearRange)}` : '';\n  };\n\n  const yearRangeToPrevDecadeLabel = (yearRange: ICalendarYearRange) => {\n    return strings.prevYearRangeAriaLabel ? `${strings.prevYearRangeAriaLabel} ${yearRangeToString(yearRange)}` : '';\n  };\n\n  return [\n    yearToString,\n    {\n      rangeAriaLabel: yearRangeToString,\n      prevRangeAriaLabel: yearRangeToPrevDecadeLabel,\n      nextRangeAriaLabel: yearRangeToNextDecadeLabel,\n      headerAriaLabelFormatString: strings.yearPickerHeaderAriaLabel,\n    } as const,\n  ] as const;\n}\n\nfunction isCurrentMonth(month: number, year: number, today: Date): boolean {\n  return today.getFullYear() === year && today.getMonth() === month;\n}\n\nfunction onButtonKeyDown(callback: () => void): (ev: React.KeyboardEvent<HTMLButtonElement>) => void {\n  return (ev: React.KeyboardEvent<HTMLButtonElement>) => {\n    // eslint-disable-next-line deprecation/deprecation\n    switch (ev.which) {\n      case KeyCodes.enter:\n        callback();\n        break;\n    }\n  };\n}\n"],"sourceRoot":"../src/"},"metadata":{},"sourceType":"module"}