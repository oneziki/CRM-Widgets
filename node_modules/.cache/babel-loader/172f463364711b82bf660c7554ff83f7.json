{"ast":null,"code":"import { __assign } from \"tslib\"; // Utilities\n\nimport * as React from 'react';\nimport { classNamesFunction, elementContains, focusFirstChild, getDocument, KeyCodes, getRTL, EventGroup, getPropsWithDefaults } from '../../Utilities';\nimport { RectangleEdge, getOppositeEdge } from '../../Positioning'; // Component Dependencies\n\nimport { PositioningContainer } from './PositioningContainer/index';\nimport { Beak, BEAK_HEIGHT, BEAK_WIDTH } from './Beak/Beak';\nimport { DirectionalHint } from '../../common/DirectionalHint';\nimport { COACHMARK_HEIGHT, COACHMARK_WIDTH } from './Coachmark.styles';\nimport { FocusTrapZone } from '../../FocusTrapZone';\nimport { useAsync, useOnEvent, useSetTimeout, useWarnings } from '@fluentui/react-hooks';\nvar getClassNames = classNamesFunction();\nexport var COACHMARK_ATTRIBUTE_NAME = 'data-coachmarkid';\nvar DEFAULT_PROPS = {\n  isCollapsed: true,\n  mouseProximityOffset: 10,\n  delayBeforeMouseOpen: 3600,\n  delayBeforeCoachmarkAnimation: 0,\n  isPositionForced: true,\n  positioningContainerProps: {\n    directionalHint: DirectionalHint.bottomAutoEdge\n  }\n};\n\nfunction useCollapsedState(props, entityInnerHostElementRef) {\n  var propsIsCollapsed = props.isCollapsed,\n      onAnimationOpenStart = props.onAnimationOpenStart,\n      onAnimationOpenEnd = props.onAnimationOpenEnd;\n  /** Is the Coachmark currently collapsed into a tear drop shape */\n\n  var _a = React.useState(!!propsIsCollapsed),\n      isCollapsed = _a[0],\n      setIsCollapsed = _a[1];\n\n  var setTimeout = useSetTimeout().setTimeout; // Rather than pushing out logic elsewhere to prevent openCoachmark from being called repeatedly,\n  // we'll track it here and only invoke the logic once. We do this with a ref, rather than just the state,\n  // because the openCoachmark callback can be captured in scope for an effect\n\n  var hasCoachmarkBeenOpened = React.useRef(!isCollapsed);\n  var openCoachmark = React.useCallback(function () {\n    var _a, _b;\n\n    if (!hasCoachmarkBeenOpened.current) {\n      setIsCollapsed(false);\n      onAnimationOpenStart === null || onAnimationOpenStart === void 0 ? void 0 : onAnimationOpenStart();\n      (_b = (_a = entityInnerHostElementRef.current) === null || _a === void 0 ? void 0 : _a.addEventListener) === null || _b === void 0 ? void 0 : _b.call(_a, 'transitionend', function () {\n        // Need setTimeout to trigger narrator\n        setTimeout(function () {\n          if (entityInnerHostElementRef.current) {\n            focusFirstChild(entityInnerHostElementRef.current);\n          }\n        }, 1000);\n        onAnimationOpenEnd === null || onAnimationOpenEnd === void 0 ? void 0 : onAnimationOpenEnd();\n      });\n      hasCoachmarkBeenOpened.current = true;\n    }\n  }, [entityInnerHostElementRef, onAnimationOpenEnd, onAnimationOpenStart, setTimeout]);\n  React.useEffect(function () {\n    if (!propsIsCollapsed) {\n      openCoachmark();\n    } // eslint-disable-next-line react-hooks/exhaustive-deps -- should only run if isCollapsed changes\n\n  }, [propsIsCollapsed]);\n  return [isCollapsed, openCoachmark];\n}\n\nfunction usePositionedData() {\n  var async = useAsync();\n  /**\n   * Alignment edge of callout in relation to target\n   */\n\n  var _a = React.useState(),\n      targetAlignment = _a[0],\n      setTargetAlignment = _a[1];\n  /**\n   * Position of Coachmark/TeachingBubble in relation to target\n   */\n\n\n  var _b = React.useState(),\n      targetPosition = _b[0],\n      setTargetPosition = _b[1];\n\n  var onPositioned = function (_a) {\n    var alignmentEdge = _a.alignmentEdge,\n        targetEdge = _a.targetEdge;\n    return async.requestAnimationFrame(function () {\n      setTargetAlignment(alignmentEdge);\n      setTargetPosition(targetEdge);\n    });\n  };\n\n  return [targetAlignment, targetPosition, onPositioned];\n}\n\nfunction useBeakPosition(props, targetAlignment, targetPosition) {\n  var isRTL = getRTL(props.theme);\n  return React.useMemo(function () {\n    var beakDirection = targetPosition === undefined ? RectangleEdge.bottom : getOppositeEdge(targetPosition);\n    var beakPosition = {\n      direction: beakDirection\n    };\n    var transformOriginX;\n    var transformOriginY;\n    var distanceAdjustment = '3px'; // Adjustment distance for Beak to shift towards Coachmark bubble.\n\n    switch (beakDirection) {\n      // If Beak is pointing Up or Down\n      case RectangleEdge.top:\n      case RectangleEdge.bottom:\n        // If there is no target alignment, then beak is X-axis centered in callout\n        if (!targetAlignment) {\n          beakPosition.left = \"calc(50% - \" + BEAK_WIDTH / 2 + \"px)\";\n          transformOriginX = 'center';\n        } else {\n          // Beak is aligned to the left of target\n          if (targetAlignment === RectangleEdge.left) {\n            beakPosition.left = COACHMARK_WIDTH / 2 - BEAK_WIDTH / 2 + \"px\";\n            transformOriginX = 'left';\n          } else {\n            // Beak is aligned to the right of target\n            beakPosition.right = COACHMARK_WIDTH / 2 - BEAK_WIDTH / 2 + \"px\";\n            transformOriginX = 'right';\n          }\n        }\n\n        if (beakDirection === RectangleEdge.top) {\n          beakPosition.top = distanceAdjustment;\n          transformOriginY = 'top';\n        } else {\n          beakPosition.bottom = distanceAdjustment;\n          transformOriginY = 'bottom';\n        }\n\n        break;\n      // If Beak is pointing Left or Right\n\n      case RectangleEdge.left:\n      case RectangleEdge.right:\n        // If there is no target alignment, then beak is Y-axis centered in callout\n        if (!targetAlignment) {\n          beakPosition.top = \"calc(50% - \" + BEAK_WIDTH / 2 + \"px)\";\n          transformOriginY = \"center\";\n        } else {\n          // Beak is aligned to the top of target\n          if (targetAlignment === RectangleEdge.top) {\n            beakPosition.top = COACHMARK_WIDTH / 2 - BEAK_WIDTH / 2 + \"px\";\n            transformOriginY = \"top\";\n          } else {\n            // Beak is aligned to the bottom of target\n            beakPosition.bottom = COACHMARK_WIDTH / 2 - BEAK_WIDTH / 2 + \"px\";\n            transformOriginY = \"bottom\";\n          }\n        }\n\n        if (beakDirection === RectangleEdge.left) {\n          if (isRTL) {\n            beakPosition.right = distanceAdjustment;\n          } else {\n            beakPosition.left = distanceAdjustment;\n          }\n\n          transformOriginX = 'left';\n        } else {\n          if (isRTL) {\n            beakPosition.left = distanceAdjustment;\n          } else {\n            beakPosition.right = distanceAdjustment;\n          }\n\n          transformOriginX = 'right';\n        }\n\n        break;\n    }\n\n    return [beakPosition, transformOriginX + \" \" + transformOriginY];\n  }, [targetAlignment, targetPosition, isRTL]);\n}\n\nfunction useListeners(props, translateAnimationContainer, openCoachmark) {\n  var _a;\n\n  var document = (_a = getDocument()) === null || _a === void 0 ? void 0 : _a.documentElement;\n  useOnEvent(document, 'keydown', function (e) {\n    var _a, _b; // Open coachmark if user presses ALT + C (arbitrary keypress for now)\n\n\n    if ( // eslint-disable-next-line deprecation/deprecation\n    e.altKey && e.which === KeyCodes.c || // eslint-disable-next-line deprecation/deprecation\n    e.which === KeyCodes.enter && ((_b = (_a = translateAnimationContainer.current) === null || _a === void 0 ? void 0 : _a.contains) === null || _b === void 0 ? void 0 : _b.call(_a, e.target))) {\n      openCoachmark();\n    }\n  }, true);\n\n  var dismissOnLostFocus = function (ev) {\n    var _a;\n\n    if (props.preventDismissOnLostFocus) {\n      var clickTarget = ev.target;\n      var clickedOutsideCallout = translateAnimationContainer.current && !elementContains(translateAnimationContainer.current, clickTarget);\n      var target = props.target;\n\n      if (clickedOutsideCallout && clickTarget !== target && !elementContains(target, clickTarget)) {\n        (_a = props.onDismiss) === null || _a === void 0 ? void 0 : _a.call(props, ev);\n      }\n    }\n  };\n\n  useOnEvent(document, 'click', dismissOnLostFocus, true);\n  useOnEvent(document, 'focus', dismissOnLostFocus, true);\n}\n\nfunction useProximityHandlers(props, translateAnimationContainer, openCoachmark) {\n  var _a = useSetTimeout(),\n      setTimeout = _a.setTimeout,\n      clearTimeout = _a.clearTimeout;\n  /** The target element the mouse would be in proximity to */\n\n\n  var targetElementRect = React.useRef();\n  React.useEffect(function () {\n    var setTargetElementRect = function () {\n      if (translateAnimationContainer.current) {\n        targetElementRect.current = translateAnimationContainer.current.getBoundingClientRect();\n      }\n    };\n\n    var events = new EventGroup({}); // We don't want the user to immediately trigger the Coachmark when it's opened\n\n    setTimeout(function () {\n      var _a = props.mouseProximityOffset,\n          mouseProximityOffset = _a === void 0 ? 0 : _a;\n      /** Cached ids returned when setTimeout runs during the window resize event trigger. */\n\n      var timeoutIds = []; // Take the initial measure out of the initial render to prevent an unnecessary render.\n\n      setTimeout(function () {\n        setTargetElementRect(); // When the window resizes we want to async get the bounding client rectangle.\n        // Every time the event is triggered we want to setTimeout and then clear any previous\n        // instances of setTimeout.\n\n        events.on(window, 'resize', function () {\n          timeoutIds.forEach(function (value) {\n            clearTimeout(value);\n          });\n          timeoutIds.splice(0, timeoutIds.length); // clear array\n\n          timeoutIds.push(setTimeout(function () {\n            setTargetElementRect();\n          }, 100));\n        });\n      }, 10); // Every time the document's mouse move is triggered, we want to check if inside of an element\n      // and set the state with the result.\n\n      events.on(document, 'mousemove', function (e) {\n        var _a;\n\n        var mouseY = e.clientY;\n        var mouseX = e.clientX;\n        setTargetElementRect();\n\n        if (isInsideElement(targetElementRect.current, mouseX, mouseY, mouseProximityOffset)) {\n          openCoachmark();\n        }\n\n        (_a = props.onMouseMove) === null || _a === void 0 ? void 0 : _a.call(props, e);\n      });\n    }, props.delayBeforeMouseOpen);\n    return function () {\n      return events.dispose();\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps -- should only run on mount\n  }, []);\n}\n\nfunction useComponentRef(props) {\n  var onDismiss = props.onDismiss;\n  React.useImperativeHandle(props.componentRef, function (ev) {\n    return {\n      dismiss: function () {\n        onDismiss === null || onDismiss === void 0 ? void 0 : onDismiss(ev);\n      }\n    };\n  }, [onDismiss]);\n}\n\nfunction useAriaAlert(_a) {\n  var ariaAlertText = _a.ariaAlertText;\n  var async = useAsync();\n  /** ARIA alert text to read aloud with Narrator once the Coachmark is mounted */\n\n  var _b = React.useState(),\n      alertText = _b[0],\n      setAlertText = _b[1];\n\n  React.useEffect(function () {\n    // Need to add RAF to have narrator read change in alert container\n    async.requestAnimationFrame(function () {\n      setAlertText(ariaAlertText);\n    }); // eslint-disable-next-line react-hooks/exhaustive-deps -- should only run on mount\n  }, []);\n  return alertText;\n}\n\nfunction useAutoFocus(_a) {\n  var preventFocusOnMount = _a.preventFocusOnMount;\n  var setTimeout = useSetTimeout().setTimeout;\n  /**\n   * The cached HTMLElement reference to the Entity Inner Host\n   * element.\n   */\n\n  var entityHost = React.useRef(null);\n  React.useEffect(function () {\n    if (!preventFocusOnMount) {\n      setTimeout(function () {\n        var _a;\n\n        return (_a = entityHost.current) === null || _a === void 0 ? void 0 : _a.focus();\n      }, 1000);\n    } // eslint-disable-next-line react-hooks/exhaustive-deps -- should only run on mount\n\n  }, []);\n  return entityHost;\n}\n\nfunction useEntityHostMeasurements(props, entityInnerHostElementRef) {\n  /** Is the teaching bubble currently retrieving the original dimensions of the hosted entity. */\n  var _a = React.useState(!!props.isCollapsed),\n      isMeasuring = _a[0],\n      setIsMeasuring = _a[1];\n  /** Cached width and height of _entityInnerHostElement */\n\n\n  var _b = React.useState(props.isCollapsed ? {\n    width: 0,\n    height: 0\n  } : {}),\n      entityInnerHostRect = _b[0],\n      setEntityInnerHostRect = _b[1];\n\n  var async = useAsync();\n  React.useEffect(function () {\n    async.requestAnimationFrame(function () {\n      if (entityInnerHostElementRef.current) {\n        setEntityInnerHostRect({\n          width: entityInnerHostElementRef.current.offsetWidth,\n          height: entityInnerHostElementRef.current.offsetHeight\n        });\n        setIsMeasuring(false);\n      }\n    }); // eslint-disable-next-line react-hooks/exhaustive-deps -- should only run on mount\n  }, []);\n  return [isMeasuring, entityInnerHostRect];\n}\n\nfunction useDeprecationWarning(props) {\n  if (process.env.NODE_ENV !== 'production') {\n    // eslint-disable-next-line react-hooks/rules-of-hooks -- build-time conditional\n    useWarnings({\n      name: COMPONENT_NAME,\n      props: props,\n      deprecations: {\n        teachingBubbleRef: undefined,\n        collapsed: 'isCollapsed',\n        beakWidth: undefined,\n        beakHeight: undefined,\n        width: undefined,\n        height: undefined\n      }\n    });\n  }\n}\n\nvar COMPONENT_NAME = 'CoachmarkBase';\nexport var CoachmarkBase = React.forwardRef(function (propsWithoutDefaults, forwardedRef) {\n  var props = getPropsWithDefaults(DEFAULT_PROPS, propsWithoutDefaults);\n  var entityInnerHostElementRef = React.useRef(null);\n  var translateAnimationContainer = React.useRef(null);\n\n  var _a = usePositionedData(),\n      targetAlignment = _a[0],\n      targetPosition = _a[1],\n      onPositioned = _a[2];\n\n  var _b = useCollapsedState(props, entityInnerHostElementRef),\n      isCollapsed = _b[0],\n      openCoachmark = _b[1];\n\n  var _c = useBeakPosition(props, targetAlignment, targetPosition),\n      beakPositioningProps = _c[0],\n      transformOrigin = _c[1];\n\n  var _d = useEntityHostMeasurements(props, entityInnerHostElementRef),\n      isMeasuring = _d[0],\n      entityInnerHostRect = _d[1];\n\n  var alertText = useAriaAlert(props);\n  var entityHost = useAutoFocus(props);\n  useListeners(props, translateAnimationContainer, openCoachmark);\n  useComponentRef(props);\n  useProximityHandlers(props, translateAnimationContainer, openCoachmark);\n  useDeprecationWarning(props);\n  var beaconColorOne = props.beaconColorOne,\n      beaconColorTwo = props.beaconColorTwo,\n      children = props.children,\n      target = props.target,\n      color = props.color,\n      positioningContainerProps = props.positioningContainerProps,\n      ariaDescribedBy = props.ariaDescribedBy,\n      ariaDescribedByText = props.ariaDescribedByText,\n      ariaLabelledBy = props.ariaLabelledBy,\n      ariaLabelledByText = props.ariaLabelledByText,\n      ariaAlertText = props.ariaAlertText,\n      delayBeforeCoachmarkAnimation = props.delayBeforeCoachmarkAnimation,\n      styles = props.styles,\n      theme = props.theme,\n      className = props.className,\n      persistentBeak = props.persistentBeak; // Defaulting the main background before passing it to the styles because it is used for `Beak` too.\n\n  var defaultColor = color;\n\n  if (!defaultColor && theme) {\n    defaultColor = theme.semanticColors.primaryButtonBackground;\n  }\n\n  var classNames = getClassNames(styles, {\n    theme: theme,\n    beaconColorOne: beaconColorOne,\n    beaconColorTwo: beaconColorTwo,\n    className: className,\n    isCollapsed: isCollapsed,\n    isMeasuring: isMeasuring,\n    color: defaultColor,\n    transformOrigin: transformOrigin,\n    entityHostHeight: entityInnerHostRect.height === undefined ? undefined : entityInnerHostRect.height + \"px\",\n    entityHostWidth: entityInnerHostRect.width === undefined ? undefined : entityInnerHostRect.width + \"px\",\n    width: COACHMARK_WIDTH + \"px\",\n    height: COACHMARK_HEIGHT + \"px\",\n    delayBeforeCoachmarkAnimation: delayBeforeCoachmarkAnimation + \"ms\"\n  });\n  var finalHeight = isCollapsed ? COACHMARK_HEIGHT : entityInnerHostRect.height;\n  return React.createElement(PositioningContainer, __assign({\n    target: target,\n    offsetFromTarget: BEAK_HEIGHT,\n    finalHeight: finalHeight,\n    ref: forwardedRef,\n    onPositioned: onPositioned,\n    bounds: getBounds(props)\n  }, positioningContainerProps), React.createElement(\"div\", {\n    className: classNames.root\n  }, ariaAlertText && React.createElement(\"div\", {\n    className: classNames.ariaContainer,\n    role: \"alert\",\n    \"aria-hidden\": !isCollapsed\n  }, alertText), React.createElement(\"div\", {\n    className: classNames.pulsingBeacon\n  }), React.createElement(\"div\", {\n    className: classNames.translateAnimationContainer,\n    ref: translateAnimationContainer\n  }, React.createElement(\"div\", {\n    className: classNames.scaleAnimationLayer\n  }, React.createElement(\"div\", {\n    className: classNames.rotateAnimationLayer\n  }, (isCollapsed || persistentBeak) && React.createElement(Beak, __assign({}, beakPositioningProps, {\n    color: defaultColor\n  })), React.createElement(\"div\", {\n    className: classNames.entityHost,\n    ref: entityHost,\n    tabIndex: -1,\n    \"data-is-focusable\": true,\n    role: \"dialog\",\n    \"aria-labelledby\": ariaLabelledBy,\n    \"aria-describedby\": ariaDescribedBy\n  }, isCollapsed && [ariaLabelledBy && React.createElement(\"p\", {\n    id: ariaLabelledBy,\n    key: 0,\n    className: classNames.ariaContainer\n  }, ariaLabelledByText), ariaDescribedBy && React.createElement(\"p\", {\n    id: ariaDescribedBy,\n    key: 1,\n    className: classNames.ariaContainer\n  }, ariaDescribedByText)], React.createElement(FocusTrapZone, {\n    isClickableOutsideFocusTrap: true,\n    forceFocusInsideTrap: false\n  }, React.createElement(\"div\", {\n    className: classNames.entityInnerHost,\n    ref: entityInnerHostElementRef\n  }, React.createElement(\"div\", {\n    className: classNames.childrenContainer,\n    \"aria-hidden\": isCollapsed\n  }, children)))))))));\n});\nCoachmarkBase.displayName = COMPONENT_NAME;\n\nfunction getBounds(_a) {\n  var isPositionForced = _a.isPositionForced,\n      positioningContainerProps = _a.positioningContainerProps;\n\n  if (isPositionForced) {\n    // If directionalHint direction is the top or bottom auto edge, then we want to set the left/right bounds\n    // to the window x-axis to have auto positioning work correctly.\n    if (positioningContainerProps && (positioningContainerProps.directionalHint === DirectionalHint.topAutoEdge || positioningContainerProps.directionalHint === DirectionalHint.bottomAutoEdge)) {\n      return {\n        left: 0,\n        top: -Infinity,\n        bottom: Infinity,\n        right: window.innerWidth,\n        width: window.innerWidth,\n        height: Infinity\n      };\n    } else {\n      return {\n        left: -Infinity,\n        top: -Infinity,\n        bottom: Infinity,\n        right: Infinity,\n        width: Infinity,\n        height: Infinity\n      };\n    }\n  } else {\n    return undefined;\n  }\n}\n\nfunction isInsideElement(targetElementRect, mouseX, mouseY, mouseProximityOffset) {\n  if (mouseProximityOffset === void 0) {\n    mouseProximityOffset = 0;\n  }\n\n  return mouseX > targetElementRect.left - mouseProximityOffset && mouseX < targetElementRect.left + targetElementRect.width + mouseProximityOffset && mouseY > targetElementRect.top - mouseProximityOffset && mouseY < targetElementRect.top + targetElementRect.height + mouseProximityOffset;\n}","map":{"version":3,"sources":["components/Coachmark/Coachmark.base.tsx"],"names":[],"mappings":"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","sourcesContent":["// Utilities\nimport * as React from 'react';\nimport {\n  classNamesFunction,\n  elementContains,\n  focusFirstChild,\n  getDocument,\n  IRectangle,\n  KeyCodes,\n  getRTL,\n  EventGroup,\n  getPropsWithDefaults,\n} from '../../Utilities';\nimport { IPositionedData, RectangleEdge, getOppositeEdge } from '../../Positioning';\n\n// Component Dependencies\nimport { PositioningContainer } from './PositioningContainer/index';\nimport { Beak, BEAK_HEIGHT, BEAK_WIDTH } from './Beak/Beak';\nimport { DirectionalHint } from '../../common/DirectionalHint';\n\n// Coachmark\nimport { ICoachmarkProps, ICoachmarkStyles, ICoachmarkStyleProps } from './Coachmark.types';\nimport { COACHMARK_HEIGHT, COACHMARK_WIDTH } from './Coachmark.styles';\nimport { FocusTrapZone } from '../../FocusTrapZone';\nimport { useAsync, useOnEvent, useSetTimeout, useWarnings } from '@fluentui/react-hooks';\nimport { IBeakProps } from './Beak/Beak.types';\n\nconst getClassNames = classNamesFunction<ICoachmarkStyleProps, ICoachmarkStyles>();\n\nexport const COACHMARK_ATTRIBUTE_NAME = 'data-coachmarkid';\n\n/**\n * An interface for the cached dimensions of entity inner host.\n */\nexport interface IEntityRect {\n  width?: number;\n  height?: number;\n}\n\ntype BeakPosition = Pick<IBeakProps, 'left' | 'top' | 'right' | 'bottom' | 'direction'>;\n\nconst DEFAULT_PROPS: Partial<ICoachmarkProps> = {\n  isCollapsed: true,\n  mouseProximityOffset: 10,\n  delayBeforeMouseOpen: 3600, // The approximate time the coachmark shows up\n  delayBeforeCoachmarkAnimation: 0,\n  isPositionForced: true,\n  positioningContainerProps: {\n    directionalHint: DirectionalHint.bottomAutoEdge,\n  },\n};\n\nfunction useCollapsedState(props: ICoachmarkProps, entityInnerHostElementRef: React.RefObject<HTMLDivElement>) {\n  const { isCollapsed: propsIsCollapsed, onAnimationOpenStart, onAnimationOpenEnd } = props;\n\n  /** Is the Coachmark currently collapsed into a tear drop shape */\n  const [isCollapsed, setIsCollapsed] = React.useState<boolean>(!!propsIsCollapsed);\n  const { setTimeout } = useSetTimeout();\n\n  // Rather than pushing out logic elsewhere to prevent openCoachmark from being called repeatedly,\n  // we'll track it here and only invoke the logic once. We do this with a ref, rather than just the state,\n  // because the openCoachmark callback can be captured in scope for an effect\n  const hasCoachmarkBeenOpened = React.useRef(!isCollapsed);\n\n  const openCoachmark = React.useCallback(() => {\n    if (!hasCoachmarkBeenOpened.current) {\n      setIsCollapsed(false);\n\n      onAnimationOpenStart?.();\n\n      entityInnerHostElementRef.current?.addEventListener?.('transitionend', (): void => {\n        // Need setTimeout to trigger narrator\n        setTimeout(() => {\n          if (entityInnerHostElementRef.current) {\n            focusFirstChild(entityInnerHostElementRef.current);\n          }\n        }, 1000);\n\n        onAnimationOpenEnd?.();\n      });\n      hasCoachmarkBeenOpened.current = true;\n    }\n  }, [entityInnerHostElementRef, onAnimationOpenEnd, onAnimationOpenStart, setTimeout]);\n\n  React.useEffect(() => {\n    if (!propsIsCollapsed) {\n      openCoachmark();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- should only run if isCollapsed changes\n  }, [propsIsCollapsed]);\n\n  return [isCollapsed, openCoachmark] as const;\n}\n\nfunction usePositionedData() {\n  const async = useAsync();\n\n  /**\n   * Alignment edge of callout in relation to target\n   */\n  const [targetAlignment, setTargetAlignment] = React.useState<RectangleEdge | undefined>();\n  /**\n   * Position of Coachmark/TeachingBubble in relation to target\n   */\n  const [targetPosition, setTargetPosition] = React.useState<RectangleEdge | undefined>();\n\n  const onPositioned = ({ alignmentEdge, targetEdge }: IPositionedData) =>\n    async.requestAnimationFrame(() => {\n      setTargetAlignment(alignmentEdge);\n      setTargetPosition(targetEdge);\n    });\n\n  return [targetAlignment, targetPosition, onPositioned] as const;\n}\n\nfunction useBeakPosition(\n  props: ICoachmarkProps,\n  targetAlignment: RectangleEdge | undefined,\n  targetPosition: RectangleEdge | undefined,\n) {\n  const isRTL = getRTL(props.theme);\n\n  return React.useMemo(() => {\n    const beakDirection = targetPosition === undefined ? RectangleEdge.bottom : getOppositeEdge(targetPosition);\n\n    const beakPosition: BeakPosition = { direction: beakDirection };\n\n    let transformOriginX: string;\n    let transformOriginY: string;\n\n    const distanceAdjustment = '3px'; // Adjustment distance for Beak to shift towards Coachmark bubble.\n\n    switch (beakDirection) {\n      // If Beak is pointing Up or Down\n      case RectangleEdge.top:\n      case RectangleEdge.bottom:\n        // If there is no target alignment, then beak is X-axis centered in callout\n        if (!targetAlignment) {\n          beakPosition.left = `calc(50% - ${BEAK_WIDTH / 2}px)`;\n          transformOriginX = 'center';\n        } else {\n          // Beak is aligned to the left of target\n          if (targetAlignment === RectangleEdge.left) {\n            beakPosition.left = `${COACHMARK_WIDTH / 2 - BEAK_WIDTH / 2}px`;\n            transformOriginX = 'left';\n          } else {\n            // Beak is aligned to the right of target\n            beakPosition.right = `${COACHMARK_WIDTH / 2 - BEAK_WIDTH / 2}px`;\n            transformOriginX = 'right';\n          }\n        }\n\n        if (beakDirection === RectangleEdge.top) {\n          beakPosition.top = distanceAdjustment;\n          transformOriginY = 'top';\n        } else {\n          beakPosition.bottom = distanceAdjustment;\n          transformOriginY = 'bottom';\n        }\n        break;\n      // If Beak is pointing Left or Right\n      case RectangleEdge.left:\n      case RectangleEdge.right:\n        // If there is no target alignment, then beak is Y-axis centered in callout\n        if (!targetAlignment) {\n          beakPosition.top = `calc(50% - ${BEAK_WIDTH / 2}px)`;\n          transformOriginY = `center`;\n        } else {\n          // Beak is aligned to the top of target\n          if (targetAlignment === RectangleEdge.top) {\n            beakPosition.top = `${COACHMARK_WIDTH / 2 - BEAK_WIDTH / 2}px`;\n            transformOriginY = `top`;\n          } else {\n            // Beak is aligned to the bottom of target\n            beakPosition.bottom = `${COACHMARK_WIDTH / 2 - BEAK_WIDTH / 2}px`;\n            transformOriginY = `bottom`;\n          }\n        }\n\n        if (beakDirection === RectangleEdge.left) {\n          if (isRTL) {\n            beakPosition.right = distanceAdjustment;\n          } else {\n            beakPosition.left = distanceAdjustment;\n          }\n          transformOriginX = 'left';\n        } else {\n          if (isRTL) {\n            beakPosition.left = distanceAdjustment;\n          } else {\n            beakPosition.right = distanceAdjustment;\n          }\n          transformOriginX = 'right';\n        }\n        break;\n    }\n\n    return [beakPosition as Readonly<BeakPosition>, `${transformOriginX} ${transformOriginY}`] as const;\n  }, [targetAlignment, targetPosition, isRTL]);\n}\n\nfunction useListeners(\n  props: ICoachmarkProps,\n  translateAnimationContainer: React.RefObject<HTMLDivElement>,\n  openCoachmark: () => void,\n) {\n  const document = getDocument()?.documentElement;\n\n  useOnEvent(\n    document,\n    'keydown',\n    (e: KeyboardEvent) => {\n      // Open coachmark if user presses ALT + C (arbitrary keypress for now)\n      if (\n        // eslint-disable-next-line deprecation/deprecation\n        (e.altKey && e.which === KeyCodes.c) ||\n        // eslint-disable-next-line deprecation/deprecation\n        (e.which === KeyCodes.enter && translateAnimationContainer.current?.contains?.(e.target as Node))\n      ) {\n        openCoachmark();\n      }\n    },\n    true,\n  );\n\n  const dismissOnLostFocus = (ev: Event) => {\n    if (props.preventDismissOnLostFocus) {\n      const clickTarget = ev.target as HTMLElement;\n      const clickedOutsideCallout =\n        translateAnimationContainer.current && !elementContains(translateAnimationContainer.current, clickTarget);\n\n      const { target } = props;\n\n      if (clickedOutsideCallout && clickTarget !== target && !elementContains(target as HTMLElement, clickTarget)) {\n        props.onDismiss?.(ev);\n      }\n    }\n  };\n\n  useOnEvent(document, 'click', dismissOnLostFocus, true);\n  useOnEvent(document, 'focus', dismissOnLostFocus, true);\n}\n\nfunction useProximityHandlers(\n  props: ICoachmarkProps,\n  translateAnimationContainer: React.RefObject<HTMLDivElement>,\n  openCoachmark: () => void,\n) {\n  const { setTimeout, clearTimeout } = useSetTimeout();\n\n  /** The target element the mouse would be in proximity to */\n  const targetElementRect = React.useRef<DOMRect>();\n\n  React.useEffect(() => {\n    const setTargetElementRect = (): void => {\n      if (translateAnimationContainer.current) {\n        targetElementRect.current = translateAnimationContainer.current.getBoundingClientRect();\n      }\n    };\n\n    const events = new EventGroup({});\n\n    // We don't want the user to immediately trigger the Coachmark when it's opened\n    setTimeout(() => {\n      const { mouseProximityOffset = 0 } = props;\n\n      /** Cached ids returned when setTimeout runs during the window resize event trigger. */\n      const timeoutIds: number[] = [];\n\n      // Take the initial measure out of the initial render to prevent an unnecessary render.\n      setTimeout(() => {\n        setTargetElementRect();\n\n        // When the window resizes we want to async get the bounding client rectangle.\n        // Every time the event is triggered we want to setTimeout and then clear any previous\n        // instances of setTimeout.\n        events.on(window, 'resize', (): void => {\n          timeoutIds.forEach((value: number): void => {\n            clearTimeout(value);\n          });\n          timeoutIds.splice(0, timeoutIds.length); // clear array\n\n          timeoutIds.push(\n            setTimeout((): void => {\n              setTargetElementRect();\n            }, 100),\n          );\n        });\n      }, 10);\n\n      // Every time the document's mouse move is triggered, we want to check if inside of an element\n      // and set the state with the result.\n      events.on(document, 'mousemove', (e: MouseEvent) => {\n        const mouseY = e.clientY;\n        const mouseX = e.clientX;\n        setTargetElementRect();\n\n        if (isInsideElement(targetElementRect.current!, mouseX, mouseY, mouseProximityOffset)) {\n          openCoachmark();\n        }\n\n        props.onMouseMove?.(e);\n      });\n    }, props.delayBeforeMouseOpen!);\n\n    return () => events.dispose();\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- should only run on mount\n  }, []);\n}\n\nfunction useComponentRef(props: ICoachmarkProps) {\n  const { onDismiss } = props;\n  React.useImperativeHandle(\n    props.componentRef,\n    (ev?: Event | React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement>) => ({\n      dismiss() {\n        onDismiss?.(ev);\n      },\n    }),\n    [onDismiss],\n  );\n}\n\nfunction useAriaAlert({ ariaAlertText }: ICoachmarkProps) {\n  const async = useAsync();\n\n  /** ARIA alert text to read aloud with Narrator once the Coachmark is mounted */\n  const [alertText, setAlertText] = React.useState<string | undefined>();\n\n  React.useEffect(() => {\n    // Need to add RAF to have narrator read change in alert container\n    async.requestAnimationFrame(() => {\n      setAlertText(ariaAlertText);\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- should only run on mount\n  }, []);\n\n  return alertText;\n}\n\nfunction useAutoFocus({ preventFocusOnMount }: ICoachmarkProps) {\n  const { setTimeout } = useSetTimeout();\n\n  /**\n   * The cached HTMLElement reference to the Entity Inner Host\n   * element.\n   */\n  const entityHost = React.useRef<HTMLDivElement | null>(null);\n\n  React.useEffect(() => {\n    if (!preventFocusOnMount) {\n      setTimeout(() => entityHost.current?.focus(), 1000);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- should only run on mount\n  }, []);\n\n  return entityHost;\n}\n\nfunction useEntityHostMeasurements(props: ICoachmarkProps, entityInnerHostElementRef: React.RefObject<HTMLDivElement>) {\n  /** Is the teaching bubble currently retrieving the original dimensions of the hosted entity. */\n  const [isMeasuring, setIsMeasuring] = React.useState<boolean>(!!props.isCollapsed);\n  /** Cached width and height of _entityInnerHostElement */\n  const [entityInnerHostRect, setEntityInnerHostRect] = React.useState<IEntityRect>(\n    props.isCollapsed ? { width: 0, height: 0 } : {},\n  );\n  const async = useAsync();\n\n  React.useEffect(() => {\n    async.requestAnimationFrame(() => {\n      if (entityInnerHostElementRef.current) {\n        setEntityInnerHostRect({\n          width: entityInnerHostElementRef.current.offsetWidth,\n          height: entityInnerHostElementRef.current.offsetHeight,\n        });\n        setIsMeasuring(false);\n      }\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- should only run on mount\n  }, []);\n\n  return [isMeasuring, entityInnerHostRect] as const;\n}\n\nfunction useDeprecationWarning(props: ICoachmarkProps) {\n  if (process.env.NODE_ENV !== 'production') {\n    // eslint-disable-next-line react-hooks/rules-of-hooks -- build-time conditional\n    useWarnings({\n      name: COMPONENT_NAME,\n      props,\n      deprecations: {\n        teachingBubbleRef: undefined,\n        collapsed: 'isCollapsed',\n        beakWidth: undefined,\n        beakHeight: undefined,\n        width: undefined,\n        height: undefined,\n      },\n    });\n  }\n}\n\nconst COMPONENT_NAME = 'CoachmarkBase';\n\nexport const CoachmarkBase: React.FunctionComponent<ICoachmarkProps> = React.forwardRef<\n  HTMLDivElement,\n  ICoachmarkProps\n>((propsWithoutDefaults, forwardedRef) => {\n  const props = getPropsWithDefaults(DEFAULT_PROPS, propsWithoutDefaults);\n\n  const entityInnerHostElementRef = React.useRef<HTMLDivElement | null>(null);\n  const translateAnimationContainer = React.useRef<HTMLDivElement | null>(null);\n\n  const [targetAlignment, targetPosition, onPositioned] = usePositionedData();\n  const [isCollapsed, openCoachmark] = useCollapsedState(props, entityInnerHostElementRef);\n  const [beakPositioningProps, transformOrigin] = useBeakPosition(props, targetAlignment, targetPosition);\n  const [isMeasuring, entityInnerHostRect] = useEntityHostMeasurements(props, entityInnerHostElementRef);\n  const alertText = useAriaAlert(props);\n  const entityHost = useAutoFocus(props);\n\n  useListeners(props, translateAnimationContainer, openCoachmark);\n  useComponentRef(props);\n  useProximityHandlers(props, translateAnimationContainer, openCoachmark);\n  useDeprecationWarning(props);\n\n  const {\n    beaconColorOne,\n    beaconColorTwo,\n    children,\n    target,\n    color,\n    positioningContainerProps,\n    ariaDescribedBy,\n    ariaDescribedByText,\n    ariaLabelledBy,\n    ariaLabelledByText,\n    ariaAlertText,\n    delayBeforeCoachmarkAnimation,\n    styles,\n    theme,\n    className,\n    persistentBeak,\n  } = props;\n\n  // Defaulting the main background before passing it to the styles because it is used for `Beak` too.\n  let defaultColor = color;\n  if (!defaultColor && theme) {\n    defaultColor = theme.semanticColors.primaryButtonBackground;\n  }\n\n  const classNames = getClassNames(styles, {\n    theme,\n    beaconColorOne,\n    beaconColorTwo,\n    className,\n    isCollapsed,\n    isMeasuring,\n    color: defaultColor,\n    transformOrigin,\n    entityHostHeight: entityInnerHostRect.height === undefined ? undefined : `${entityInnerHostRect.height}px`,\n    entityHostWidth: entityInnerHostRect.width === undefined ? undefined : `${entityInnerHostRect.width}px`,\n    width: `${COACHMARK_WIDTH}px`,\n    height: `${COACHMARK_HEIGHT}px`,\n    delayBeforeCoachmarkAnimation: `${delayBeforeCoachmarkAnimation}ms`,\n  });\n\n  const finalHeight: number | undefined = isCollapsed ? COACHMARK_HEIGHT : entityInnerHostRect.height;\n\n  return (\n    <PositioningContainer\n      target={target}\n      offsetFromTarget={BEAK_HEIGHT}\n      finalHeight={finalHeight}\n      ref={forwardedRef}\n      onPositioned={onPositioned}\n      bounds={getBounds(props)}\n      {...positioningContainerProps}\n    >\n      <div className={classNames.root}>\n        {ariaAlertText && (\n          <div className={classNames.ariaContainer} role=\"alert\" aria-hidden={!isCollapsed}>\n            {alertText}\n          </div>\n        )}\n        <div className={classNames.pulsingBeacon} />\n        <div className={classNames.translateAnimationContainer} ref={translateAnimationContainer}>\n          <div className={classNames.scaleAnimationLayer}>\n            <div className={classNames.rotateAnimationLayer}>\n              {(isCollapsed || persistentBeak) && <Beak {...beakPositioningProps} color={defaultColor} />}\n              <div\n                className={classNames.entityHost}\n                ref={entityHost}\n                tabIndex={-1}\n                data-is-focusable={true}\n                role=\"dialog\"\n                aria-labelledby={ariaLabelledBy}\n                aria-describedby={ariaDescribedBy}\n              >\n                {isCollapsed && [\n                  ariaLabelledBy && (\n                    <p id={ariaLabelledBy} key={0} className={classNames.ariaContainer}>\n                      {ariaLabelledByText}\n                    </p>\n                  ),\n                  ariaDescribedBy && (\n                    <p id={ariaDescribedBy} key={1} className={classNames.ariaContainer}>\n                      {ariaDescribedByText}\n                    </p>\n                  ),\n                ]}\n                <FocusTrapZone isClickableOutsideFocusTrap={true} forceFocusInsideTrap={false}>\n                  <div className={classNames.entityInnerHost} ref={entityInnerHostElementRef}>\n                    <div className={classNames.childrenContainer} aria-hidden={isCollapsed}>\n                      {children}\n                    </div>\n                  </div>\n                </FocusTrapZone>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </PositioningContainer>\n  );\n});\nCoachmarkBase.displayName = COMPONENT_NAME;\n\nfunction getBounds({ isPositionForced, positioningContainerProps }: ICoachmarkProps): IRectangle | undefined {\n  if (isPositionForced) {\n    // If directionalHint direction is the top or bottom auto edge, then we want to set the left/right bounds\n    // to the window x-axis to have auto positioning work correctly.\n    if (\n      positioningContainerProps &&\n      (positioningContainerProps.directionalHint === DirectionalHint.topAutoEdge ||\n        positioningContainerProps.directionalHint === DirectionalHint.bottomAutoEdge)\n    ) {\n      return {\n        left: 0,\n        top: -Infinity,\n        bottom: Infinity,\n        right: window.innerWidth,\n        width: window.innerWidth,\n        height: Infinity,\n      };\n    } else {\n      return {\n        left: -Infinity,\n        top: -Infinity,\n        bottom: Infinity,\n        right: Infinity,\n        width: Infinity,\n        height: Infinity,\n      };\n    }\n  } else {\n    return undefined;\n  }\n}\n\nfunction isInsideElement(\n  targetElementRect: ClientRect,\n  mouseX: number,\n  mouseY: number,\n  mouseProximityOffset: number = 0,\n): boolean {\n  return (\n    mouseX > targetElementRect.left - mouseProximityOffset &&\n    mouseX < targetElementRect.left + targetElementRect.width + mouseProximityOffset &&\n    mouseY > targetElementRect.top - mouseProximityOffset &&\n    mouseY < targetElementRect.top + targetElementRect.height + mouseProximityOffset\n  );\n}\n"],"sourceRoot":"../src/"},"metadata":{},"sourceType":"module"}